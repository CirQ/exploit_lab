## lab04

**Level C**
First I take a look to the source code, then make some conclusion:

+ The flag file is intentionally load into variable `real_pass`, if I input this string correctly, a shell will be spawned (it is not the real solution, obviously).
+ Statement at line 60 is exploitable since it directedly outputs a user specified string without formatting.

The approach is straight forward, to input some crafted format string to read variable `real_pass`.

At machine code level, we may infer the addresses of these variables:

|variable|offset|address|
|--|--|--|
|`username`|`esp+0x94`|`0xbffff624`|
|`real_pass`|`esp+0x76`|`0xbffff606`|
|`in_pass`|`esp+0x12`|`0xbffff5a2`|

The address of `in_pass` can be obtained from some probing format strings (the first string prints the content of `in_pass` and the next one shows its address):

![probing](04c1.png)

Next step is to find the currently offset of `username` when the control flow is at line 60. I obtain it manually:

![stupidmanually](04c2.png)

It is now at `%37$08x`. Then by the address of `real_pass`, I am able to obtain the content:

![flagc](04c3.png)

The flag is `bu7_1t_w4sn7_brUt3_f0rc34b1e!`.

---

**Level B**

---

**Level A**
